/*! navitron 0.0.1 (https://github.com/mobify/navitron.git) */
!function(a){if("function"==typeof define&&define.amd)define(["$","plugin","velocity"],a);else{var b=window.Zepto||window.jQuery;a(b,window.Plugin,window.Velocity)}}(function(a,b,c){function d(a,b){d.__super__.call(this,a,b,d.DEFAULTS)}var e={PANE:".navitron__pane",NESTED_PANE:".navitron__nested > .navitron__pane",ITEM:".navitron__item",NEXT_PANE:".navitron__next-pane",PREV_PANE:".navitron__prev-pane"};return d.VERSION="0.0.1",d.DEFAULTS={shiftAmount:20,duration:200,easing:"swing",fadeOpacityTo:.25,currentPane:"0",mobileHA:!0,show:a.noop},b.create("navitron",d,{_init:function(b){this.$original=a(b),this._validateOptions(),this._labelTree(),this._build(),this.$currentPane=this._getTargetPane(this.options.currentPane),this._addAccessibility(),this._setAnimationDefaults(),this._bindEvents()},destroy:function(){this.$navitron.removeData(this.name)},_labelTree:function(){var b="> li > ul";for(this.$original.attr("data-level","0");;){var c=this.$original.find(b);if(!c.length)break;c.each(function(b,c){var d=a(c),e=d.parents("ul").first();e.length&&d.attr("data-level",e.attr("data-level")+"."+b)}),b+=b}},_build:function(){var b=this,c=a("<nav />"),d=a("<div />").addClass("navitron__nested"),e=a("<div />").addClass("navitron__pane"),f=a('<button type="button" />').addClass("navitron__item"),g=this.$original.attr("id"),h=this.$original.attr("class"),i=this.$original.children("li"),j=function(c){c.each(function(c,g){var h=a(g),i=h.children("ul").remove();if(i.length){var k=i.data("level"),l=b._getParentLevel(k);i.removeAttr("data-level");var m=f.clone().text("Back").addClass("navitron__prev-pane").attr("data-target-pane",l);m.wrap("<li />").parent().prependTo(i);var n=h.text().trim();h.html(f.clone().text(n).attr("data-target-pane",k).addClass("navitron__next-pane")),i.wrap(e.clone()).parent().attr("data-level",k).appendTo(d);var o=i.children("li");o.length&&j(o)}})};c.attr("id",g),c.attr("class",h),this.$original.removeAttr("id"),this.$original.removeAttr("class"),this.$original.removeAttr("data-level"),this.$original.wrap(c),this.$original.wrap(e.clone().attr("data-level",0)),d.appendTo(c),j(i),this.$navitron=c},_getParentLevel:function(a){var b=a.split(".");return b.pop(),b.join(".")},_addAccessibility:function(){this.$navitron.attr("role","tree"),this.$navitron.find(e.PANE).attr("aria-hidden","false"),this.$navitron.find(e.NESTED_PANE).each(function(b,c){var d=a(c),e=d.data("level");d.attr("role","group").attr("aria-hidden","true").attr("id","Navitron_"+e)}),this.$navitron.find(e.ITEM).attr("role","treeitem"),this.$navitron.find(e.NEXT_PANE).each(function(b,c){var d=a(c),e=d.data("target-pane");d.attr("aria-expanded","false").attr("aria-owns","Navitron_"+e)})},_validateOptions:function(){if(this.options.fadeOpacityTo<0||this.options.fadeOpacityTo>1)throw new Error("The fadeOpacityTo value should be in the range from 0 to 1.0.")},_setAnimationDefaults:function(){this.animationDefaults={easing:this.options.easing,duration:this.options.duration,mobileHA:this.options.mobileHA}},_bindEvents:function(){var b=this;this.$navitron.on("click",e.NEXT_PANE,function(){var c=a(this),d=c.data(),e=b._getTargetPane(d.targetPane);if(c.is("a")||c.has("a").length||!e.length){if(!e.length)throw new Error("Target pane with ID: "+d.targetPane+" does not exist!")}else b.showPane(e),c.attr("aria-expanded","true")}),this.$navitron.on("click",e.PREV_PANE,function(){var c=a(this);b._hidePane(b.$currentPane,c)})},showPane:function(b){if(!b.length)throw new Error("The showPane method requires a pane element to show");var d=this;c.animate(b,{translateX:["-100%",0]},a.extend(!0,{},this.animationDefaults,{display:"block",begin:function(){d._trigger("show"),b.css({zIndex:2})},complete:function(){b.attr("aria-hidden","false"),b.focus(),d._trigger("shown"),d._setCurrentPane(b)}})),d._hideCurrentPane()},_hideCurrentPane:function(){var b=this.$currentPane,d=this._getTranslateX(b);c.animate(b,{translateX:[d-this.options.shiftAmount+"%",d+"%"],opacity:[this.options.fadeOpacityTo,1]},a.extend(!0,{},this.animationDefaults,{display:"none",begin:function(){b.css({zIndex:1})},complete:function(){b.attr("aria-hidden","true")}}))},_hidePane:function(b,d){var e=this;c.animate(b,{translateX:[0,"-100%"]},a.extend(!0,{},this.animationDefaults,{display:"none",begin:function(){b.css({zIndex:2})},complete:function(){b.attr("aria-hidden","true")}})),e._showPreviousPane(d)},_showPreviousPane:function(b){var d=this,f=b.data(),g=this._getTargetPane(f.targetPane),h=this._getTranslateX(g);c.animate(g,{translateX:[h+this.options.shiftAmount+"%",h+"%"],opacity:[1,this.options.fadeOpacityTo]},a.extend(!0,{},this.animationDefaults,{display:"block",begin:function(){g.css({zIndex:1})},complete:function(){g.attr("aria-hidden","false").find(e.NEXT_PANE+'[data-target-pane="'+f.currentPane+'"]').attr("aria-expanded","false"),d._setCurrentPane(g)}}))},_setCurrentPane:function(a){this.$currentPane=a},_getTargetPane:function(a){return this.$navitron.find(e.PANE+'[data-level="'+a+'"]')},_getTranslateX:function(a){return parseFloat(c.CSS.getPropertyValue(a[0],"translateX"))}}),a("[data-navitron]").navitron(),a});